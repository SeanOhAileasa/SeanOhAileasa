<!----><div><h1>Web Attacker Methodology</h1>
<p>In this Topic, we will cover the following Learning Units:</p>
<ul>
<li>Introduction to Web Application Assessments</li>
<li>Enumeration</li>
<li>Vulnerability Discovery</li>
<li>Exploitation</li>
<li>Post-Exploitation</li>
<li>Reporting</li>
</ul>
<p>Each learner moves at their own pace, but this Topic should take
approximately 3 hours to complete.</p>
<p>Some might consider a web application to be an individual system,
but web applications often contain connections to other systems that
can allow an attacker to gain a foothold on an internal network.
Therefore, assessing the security of a web application is an important
part of establishing the security posture of both the application and
the organization or company that owns it. As we assess an application,
we must think like an attacker to identify flaws that we can exploit
to gain further access to the application, or use to obtain sensitive
data.</p>
<p>In this Topic, we will introduce the phases of web application
assessments and cover the commonly used methodology for each phase.
However, this topic will not cover web application vulnerabilities or
their exploitation in-depth. The WEB-200 course covers this material.</p>
</div><!---->

<!----><div><h2>Introduction to Web Application Assessments</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand what a web application assessment is</li>
<li>Understand why web application assessments are performed</li>
<li>Understand how web application assessments relate to penetration
tests</li>
<li>Understand the conceptual phases of a web application assessment</li>
</ol>
<p>This Learning Unit will take approximately 15 minutes to complete.</p>
<p>Many companies have web application assessments performed to help
secure their applications by proactively identifying vulnerabilities
or misconfigurations in their applications. Internal teams or
contractors might perform the assessment depending on the size and
budget of the company. Usually, web assessors conduct assessments in
non-production environments to avoid impacting production systems and
customers. However, each engagement can have its own specific rules
and expectations.</p>
<p>In this Topic, we'll refer to the company or team requesting an
assessment as the client, even if an internal team performs the
assessment.</p>
</div><!---->

<h2>Testing Scope</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>The <em>scope</em> of an assessment is the collection of the client's testing
objectives. This includes which applications are being testing, what
access the assessors have at the start of the assessment, and the
"rules" of the test, including what can and can't be done, such as
<em>phishing</em>.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></p>
<p>During an assessment, one or more assessors attempt to identify
and exploit misconfigurations and vulnerabilities based on approved
objectives. These objectives can be as broad, such as "find all
vulnerabilities in the application", or very application-specific,
such as "can you capture credit card numbers during the payment flow".</p>
<p>Each assessment has different assumptions, such as the level
of application access provided to the assessor or the availability
of source code. Some assessment owners might want to limit access
or knowledge to better mimic an actual attacker. However, providing
information to the assessors can often result in more thorough testing
coverage.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Phishing" target="_blank">https://en.wikipedia.org/wiki/Phishing</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Web Application Assessment vs Penetration Test</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Some components of web application assessments overlap with
penetration tests, but they are not the same thing. Web application
assessments tend to have broad objectives on a small group of
applications or servers. Penetration tests tend to have very specific
goals and include most, if not all, applications, servers, and
employees of the organization.</p>
<p>Penetration testers may seek to compromise a web application to gain
initial access, in which case, many of the steps performed will be
very similar to a web application assessment. However, if part of
the scope, the penetration testers could also phish users for initial
access to the internal network, completely bypassing external web
applications.</p>
</div><!----></div>

<h2>Phases of a Web Application Assessment</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>There are different security testing standards, each of which use
different definitions for the phases (or sections) of a security
assessment. The different terminologies can be confusing when we
compare two different standards. For example, the <em>Penetration
Testing Execution Standard</em> (PTES),<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>, has seven sections.
While the <em>OWASP's Web Application Security Testing</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>
methodology considers testing to be passive or active, with active
testing divided into 12 categories.</p>
<p>Regardless of the naming conventions, we will cover web application
assessments from five conceptual phases: Enumeration, Vulnerability
Discovery, Exploitation, Post-Exploitation, and Reporting.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Penetration testing execution standard (PTES), 2014), <a href="http://www.pentest-standard.org/index.php/Main_Page" target="_blank">http://www.pentest-standard.org/index.php/Main_Page</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(OWASP, 2021), <a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank">https://owasp.org/www-project-web-security-testing-guide/</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<!----><div><h2>Enumeration</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand the importance of enumeration</li>
<li>Understand how to identify web application technologies</li>
<li>Understand which automated scans are useful during enumeration</li>
<li>Understand the concept of an attack surface</li>
</ol>
<p>This Learning Unit will take approximately 30 minutes to complete.</p>
<p>During the Enumeration phase, our objective is to discover as much as
we can about the application and its users.</p>
</div><!---->

<h2>Web Stacks and Technologies</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>A <em>web stack</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> is the combination of software that
runs and supports an application. For web applications, the stack
is typically comprised of a server, an operating system, a database,
and a programming language. Not every application will fit this
definition, but it remains a useful concept.</p>
<p><em>LAMP</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> was one of the most common web stacks for
many years. Its components are Linux, Apache, MySQL, and PHP. While
we will often encounter applications running on LAMP stacks, it
can be difficult to quantify every application's stack. A website
that seems to be one application can utilize many different
<em>microservices</em>,<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> each built with different
technologies.</p>
<p>For example, an application might use NodeJS for the main UI, an API
written in Python for user authentication, and an API written in Java
for handling eCommerce transactions. If the application makes the API
calls, rather than our browser, we might not know the different APIs
exist.</p>
<p>During enumeration, we're not trying to identify a specific stack.
Rather, we should use the concept of a stack as a guiding principle to
identify the components of the application that we can interact with.
We can do this by inspecting browser requests and server responses
for useful information. If we can identify some of the software the
application uses, we can search for any known vulnerabilities during
the Vulnerability Discovery phase.</p>
<p>There are different actions we can take to try to identify different
components of a web application. Let's begin with trying to identify
what OS and web server we are enumerating.</p>
<p>The <em>Server</em> and <em>X-Powered-By</em> response headers can leak the server
software (including version number), and the application's programming
language. Some JavaScript libraries will include an <em>X-Requested-With</em>
header on requests. We can inspect server response headers using
<em>curl</em> with the <span class="pr-block">-i</span> flag to include headers in the output or
with <span class="pr-block">-I</span> to send a <em>HEAD</em><sup class="footnote-ref"><a href="#fn4" id="fnref4">4</a></sup> request and only display
the response headers. However, not all servers will respond to a HEAD
request.</p>
<p>Let's review an example.</p>
<pre id="fence-code-1" class="fence-code has-commands"><code>kali@kali:~$ <span class="code-block-ui">curl -I http://www.megacorpone.com</span>
HTTP/1.1 200 OK
Date: Tue, 28 Sep 2021 14:40:27 GMT
<span class="code-block-p">Server: Apache/2.4.38 (Debian)</span>
Last-Modified: Wed, 06 Nov 2019 15:04:14 GMT
ETag: "390b-596aedca79780"
Accept-Ranges: bytes
Content-Length: 14603
Vary: Accept-Encoding
Content-Type: text/html
</code></pre>
<blockquote>
<p>Listing 1 - Using curl to inspecting server response</p>
</blockquote>
<p>In Listing 1, the server response included a <em>Server</em>
header which lists the server software (Apache), version (2.4.38), and
operating system (Debian). Not every server will include this header
at all or include all three values.</p>
<p>Next we can move on to the programming languages and frameworks
used. We can infer these based on file extensions used in URLs,
such as <span class="fp-block">.php</span> indicating PHP and <span class="fp-block">.jsp</span> indicating
Java. However, with modern frameworks supporting programmatic
<em>routing</em>,<sup class="footnote-ref"><a href="#fn5" id="fnref5">5</a></sup> we will often encounter applications that do
not include file extensions in their URLs.</p>
<p>Depending on the application, there may be a database we want to
examine. Determining an application's database can be difficult unless
we can generate an error message that includes an identifier. Most
databases use unique error codes, such as Oracle error IDs starting
with 'ORA', which we can use to identify the database.</p>
<p>It is more difficult to manually enumerate the operating system of an
application without a verbose error message that indicates the OS or
a file path. However, many scanning tools, such as <em>nmap</em>,<sup class="footnote-ref"><a href="#fn6" id="fnref6">6</a></sup>
can guess a server's OS based on TCP fingerprinting. We will cover
automated tools in a later section.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Solution_stack" target="_blank">https://en.wikipedia.org/wiki/Solution_stack</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/LAMP_(software_bundle)" target="_blank">https://en.wikipedia.org/wiki/LAMP_(software_bundle)</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn3"><sup>3</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Microservices" target="_blank">https://en.wikipedia.org/wiki/Microservices</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn4"><sup>4</sup><p>(Mozilla, 2021), <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn5"><sup>5</sup><p>(StrongLoop, IBM, et al, 2017), <a href="https://expressjs.com/en/guide/routing.html" target="_blank">https://expressjs.com/en/guide/routing.html</a> <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn6"><sup>6</sup><p>(Nmap.org, 2021), <a href="https://nmap.org/" target="_blank">https://nmap.org/</a> <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>User Enumeration</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Once we have an idea of the technologies used by the application, we
should try to enumerate the application's users. We may want to target
these users with a client-side exploit or attempt to brute force their
passwords during the Exploitation phase.</p>
<p>But first we need to get some usernames. Depending on the site, we
might be able to crawl the site and harvest public usernames through
forums, reviews, or similar functionality. Some web applications will
leak valid user accounts through error messages during login, password
resets, or account creation. For example, an application might respond
with "Invalid username" if the username submitted isn't valid and
"Invalid password" if the username is valid, but the password provided
is incorrect.</p>
<p>If enterprise users use the web application, we should check for
patterns in usernames. Many companies will enforce a standard naming
pattern for usernames. If we can reasonably deduce the patterns
used in usernames, we can turn a list of employees into a list of
usernames.</p>
<p>For the following exercise, consult the listing below.</p>
<pre id="fence-code-2" class="fence-code"><code>mark.styles
l.draupadi
kenneth.force
t.paran
</code></pre>
<blockquote>
<p>Listing 2 - A list of usernames</p>
</blockquote>
</div><!----></div>

<h2>Automated Enumeration Scans</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>We've mainly focused on manual enumeration techniques so far. However,
automated tools can be very useful during enumeration. Let's discuss
a few types of automated scanning tools that are useful during
enumeration.</p>
<p>We previously mentioned the network scanner and security tool
nmap. While primarily a port scanner, nmap includes a scripting
engine and numerous scripts that can be used to test for security
misconfigurations and vulnerabilities.</p>
<p>But there is a vast array of other tools. Some tools will "crawl"
a site and follow links to discover content. Other tools will
attempt to brute-forcing, or "bust", content by sending a series
of HTTP requests based on wordlists. This process can generate a
lot of traffic. In contrast, a crawler generates traffic similar to
normal users. <em>Dirb</em>,<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> <em>dirbuster</em>,<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> and
<em>gobuster</em><sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> are all discovery tools.</p>
<p><em>Vulnerability scanners</em><sup class="footnote-ref"><a href="#fn4" id="fnref4">4</a></sup> are specialized tools
that test applications and servers for security misconfigurations
and vulnerabilities. Some of these scanners check for vulnerabilities
using signatures, such as service banners or by inspecting the
operating system as an authenticated, local user. Other tools
will perform a series of tests to identify vulnerabilities rather
than relying on a signature alone. One very popular scanner is
<em>Nessus</em>.<sup class="footnote-ref"><a href="#fn5" id="fnref5">5</a></sup></p>
<p>Many security tools are multi-purpose. For example, <em>Burp Suite
Professional</em><sup class="footnote-ref"><a href="#fn6" id="fnref6">6</a></sup> includes a scanner that will "crawl" a site
(following links to discover all the content) and audit any discovered
pages and forms for vulnerabilities. The Community Edition of Burp
Suite lacks the crawler and scanner functionality but is still an
essential tool for manual testing.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Pinuaga, 2014) <a href="http://dirb.sourceforge.net/about.html" target="_blank">http://dirb.sourceforge.net/about.html</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(OffSec Services Limited, 2021), <a href="https://tools.kali.org/web-applications/dirbuster" target="_blank">https://tools.kali.org/web-applications/dirbuster</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn3"><sup>3</sup><p>(OJ Reeves, 2020), <a href="https://github.com/OJ/gobuster" target="_blank">https://github.com/OJ/gobuster</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn4"><sup>4</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Vulnerability_scanner" target="_blank">https://en.wikipedia.org/wiki/Vulnerability_scanner</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn5"><sup>5</sup><p>(tenable.com, 2021), <a href="https://www.tenable.com/products/nessus/" target="_blank">https://www.tenable.com/products/nessus/</a> <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn6"><sup>6</sup><p>(PortSwigger Ltd, 2021), <a href="https://portswigger.net/burp" target="_blank">https://portswigger.net/burp</a> <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Attack Surface</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Once we've enumerated the application and its users, we need to
determine its <em>attack surface</em>.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> This is
all the components that allows us to enter data, retrieve data,
or otherwise interact with the application. We don't need to be
authenticated to start looking at the attack surface.</p>
<p>We want to identify any behavior in the application that seems unusual
and places where the application processes data we provide. We'll
focus on these parts of the application as we move on to the next
phase, Vulnerability Discovery.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Attack_surface" target="_blank">https://en.wikipedia.org/wiki/Attack_surface</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<!----><div><h2>Vulnerability Discovery</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand how automated scans identify vulnerabilities</li>
<li>Understand how manual testing identifies vulnerabilities</li>
<li>Understand the basics of source code analysis</li>
<li>Understand how third-party dependencies can introduce
vulnerabilities</li>
</ol>
<p>This Learning Unit will take approximately 30 minutes to complete.</p>
<p>During the Vulnerability Discovery phase, our objective is to discover
misconfigurations and security vulnerabilities.</p>
</div><!---->

<h2>Automated scans</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>We briefly covered automated scanning during the enumeration phase. It
is important to remember that automated tools can increase our
productivity during web application assessments or penetration
tests, but we must also understand manual exploitation techniques.
Specialized tools, such as SQLmap, have their place in our toolbox.
However, tools will not always be available in every situation and
may mistakenly identify a vulnerability that doesn't exist, also known
as a false positive, or fail to find a vulnerability that does exist,
also known as a false negative.</p>
<p>Manual techniques offer greater flexibility and customization. It is
important to remember that tools and automation make our job easier,
but they don't do the job for us.</p>
</div><!----></div>

<h2>Manual Testing</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>During manual testing, we can use a proxy tool, such as Burp Suite, or
the developer tools built-in to our browser to inspect and modify
HTTP requests to cause the web application to respond in unusual ways.
For example, we might try sending alpha characters in a field that
should only contain numbers. If the application response changes based
on this input, we might be able to infer how the application handles
errors. We can then test the error handling for misconfigurations or
vulnerabilities.</p>
<p>In addition to testing how the application handles unexpected
input, we should also verify that access controls are working
by attempting to access restricted content and test for specific
vulnerabilities, such as <em>cross-site scripting</em> (XSS)<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> or
<em>SQL injection</em>.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> The WEB-200 course covers these types of
vulnerabilities in-depth.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Cross-site_scripting" target="_blank">https://en.wikipedia.org/wiki/Cross-site_scripting</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/SQL_injection" target="_blank">https://en.wikipedia.org/wiki/SQL_injection</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Source Code Analysis</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Source code analysis is the process of reviewing application source
code for misconfigurations and security vulnerabilities. This can
be difficult and time-consuming but often identifies impactful
vulnerabilities. We can perform code analysis manually or be assisted
by <em>static analysis</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> software.</p>
<p>As the name suggests, we need actual source code to analyze. We
can easily access code for open-source projects. For closed source
applications, we may need to <em>decompile</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> or
<em>reverse engineering</em><sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> an application to obtain
readable code. These processes can sometimes include artifacts of
uncompiled code, but they are useful for providing some recoverable
code.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Static_program_analysis" target="_blank">https://en.wikipedia.org/wiki/Static_program_analysis</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Decompiler" target="_blank">https://en.wikipedia.org/wiki/Decompiler</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn3"><sup>3</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Reverse_engineering#Software" target="_blank">https://en.wikipedia.org/wiki/Reverse_engineering#Software</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Components with Known Vulnerabilities</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>If we identify any components of the application's tech stack during
enumeration, we can search the Internet for public vulnerabilities,
such as those compiled at the <em>CVE Project</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> or <em>Exploit
Database</em>.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> We may need to modify or update published
proof-of-concept exploits, but they can often be a very effective way
to compromise an out-of-date system.</p>
<p>We can also check any dependencies for known vulnerabilities
if we have access to the application's source code. <em>OWASP
Dependency-Check</em>,<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> and <em>retire.js</em><sup class="footnote-ref"><a href="#fn4" id="fnref4">4</a></sup> are
two examples of applications that can check dependencies for known
vulnerabilities.</p>
<p>Once we have one or more vulnerabilities, we can move on to the
Exploitation phase. If our attacks fail in the Exploitation phase, we
may need to revisit Vulnerability Discovery.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(The MITRE Corporation, 2021), <a href="https://cve.mitre.org/" target="_blank">https://cve.mitre.org/</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(OffSec Services Limited, 2021), <a href="https://www.exploit-db.com/" target="_blank">https://www.exploit-db.com/</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn3"><sup>3</sup><p>(OWASP, 2021), <a href="https://owasp.org/www-project-dependency-check/" target="_blank">https://owasp.org/www-project-dependency-check/</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn4"><sup>4</sup><p>(Erlend Oftedal, 2021) <a href="https://retirejs.github.io/retire.js/" target="_blank">https://retirejs.github.io/retire.js/</a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<!----><div><h2>Exploitation</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand the basic concepts of authentication bypass attacks</li>
<li>Understand the basic concepts of session hijacking</li>
<li>Understand the basic concepts of business logic flaws</li>
<li>Understand the basic concepts of data exfiltration</li>
<li>Understand the basic concepts of remote code execution</li>
</ol>
<p>This Learning Unit will take approximately 45 minutes to complete.</p>
<p>During the Exploitation phase, our objective is to gain further access
to the application or exfiltrate sensitive data by exploiting the
misconfigurations and security vulnerabilities we identified in the
previous phase.</p>
<p>Next, we'll review several conceptual types of exploits and their
potential impacts. The WEB-200 course contains more in-depth material
on web application vulnerabilities.</p>
</div><!---->

<h2>Authentication Bypass</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p><em>Authentication</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> in web applications occur when users
provide something that proves their identity. It could be an API token
or the combination of a username and password. <em>Authentication Bypass</em>
exploits allow an attacker to gain access to parts of an application
or data normally restricted to other users. These attacks might use
default credentials developers forgot to change or exploit flaws in
the login or password reset flows. For example, an application might
use static or easily guessable tokens during password resets. If an
attacker can guess or predict the next token, they could be able to
reset another user's password and gain access to their account.</p>
<p><em>Forced Browsing</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> vulnerabilities, are another
type of authentication bypass that can occur when applications only
checks authentication or authorization on certain pages or resources
under the assumption that users cannot directly browse or access them.
We can identify these resources using web content scanners.</p>
<p>Applications may be vulnerable to <em>Insecure Direct Object References</em>
(IDOR)<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> if they provide access to a resource, or
data, without verifying if the requestor should have access. We can
exploit these vulnerabilities to gain access to other users' data or
other restricted resources. If an application uses easily guessable
identifiers, such as sequential numbers, attackers will have an easier
time exploiting this vulnerability.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Authentication" target="_blank">https://en.wikipedia.org/wiki/Authentication</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(OWASP, 2021), <a href="https://owasp.org/www-community/attacks/Forced_browsing" target="_blank">https://owasp.org/www-community/attacks/Forced_browsing</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn3"><sup>3</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Insecure_direct_object_reference" target="_blank">https://en.wikipedia.org/wiki/Insecure_direct_object_reference</a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Session Hijacking</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p><em>Session Hijacking</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>, while conceptually
similar to Authentication Bypass attacks, rely on gaining access to an
existing user's <em>session</em>.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> To use this attack, we
might be able to use a cross-site scripting vulnerability to steal a
user's session cookie. Applications can also leak session identifiers
through URLs.</p>
<p>If attackers can hijack an administrative user's session, they may
be able to compromise the entire application and underlying server,
depending on the administrative functionality.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Session_hijacking" target="_blank">https://en.wikipedia.org/wiki/Session_hijacking</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Session_(computer_science)" target="_blank">https://en.wikipedia.org/wiki/Session_(computer_science)</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Business Logic Flaws</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p><em>Business Logic Flaws</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> exist when we can subvert
intended application logic to perform unintended actions. Attackers
purchasing merchandise for zero dollars or a negative amount is a
classic example of a business logic flaw. Technically, business logic
flaws are not vulnerabilities, but they can still prove useful for
attackers. Automated scanners often miss these types of flaws.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(OWASP, 2021), <a href="https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability" target="_blank">https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Data Exfiltration</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Once attackers have access to an application, they will often
attempt to steal sensitive data. This process is referred to as <em>Data
Exfiltration</em>.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> Sensitive data might include
user credentials, financial information (such as credit card numbers),
or other <em>personally identifiable information</em> (PII)<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>.
Attackers can use such data in future attacks or otherwise monetize
the data.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Data_exfiltration" target="_blank">https://en.wikipedia.org/wiki/Data_exfiltration</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Personal_data" target="_blank">https://en.wikipedia.org/wiki/Personal_data</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Remote Code Execution</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>The ultimate objective for most attackers is to achieve <em>Remote Code
Execution</em> (RCE),<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> also referred to as Arbitrary Code
Execution. RCE allows attackers to run any command on the server,
which frequently leads to the attacker gaining a shell on the server
and compromising the server and any application or database running on
it.</p>
<p>Once we have successfully exploited an application and gained a shell
on the server, we can move into the Post-Exploitation Phase.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Arbitrary_code_execution" target="_blank">https://en.wikipedia.org/wiki/Arbitrary_code_execution</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<!----><div><h2>Post-Exploitation</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand the basic concepts of post-exploitation</li>
<li>Understand the basic concepts of persistence</li>
<li>Understand the basic concepts of pivoting</li>
</ol>
<p>This Learning Unit will take approximately 15 minutes to complete.</p>
<p>In general, three common tasks in Post-Exploitation are persistence,
privilege escalation, and pivoting. However, our objectives in this
phase will be determined by the client's scope for the assessment.</p>
<p>We may find exploits that allow us to move or access a different
application or server, which is known as <em>pivoting</em>. We will cover
that shortly. However, some assessments may not include any other
in-scope applications or servers, which drastically reduces the size
of a Post-Exploitation phase.</p>
</div><!---->

<h2>Persistence</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Once we have access to the server via a shell, we need to make sure
we can get a new shell if we lose our connection. Establishing another
way to obtain a new shell is known as <em>persistence</em>. Sometimes the
initial exploit that created our shell will be repeatable. However, if
an exploit required user interaction or other special conditions, we
may want an easier way to get a new shell.</p>
<p>If the server has SSH or RDP enabled, we could add our own SSH key
or create a new user with RDP privileges. Alternatively, we could add
a new service with a vulnerability, but this approach is more inline
with a penetration test or <em>red team</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> engagement than a
web application assessment.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Red_team#Cybersecurity" target="_blank">https://en.wikipedia.org/wiki/Red_team#Cybersecurity</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Privilege Escalation</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p><em>Privilege Escalation</em><sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> is the process of
exploiting the operating system or an application to gain access to
a higher permission user. On a Linux host, we would typically try
to become the <em>root</em> user. On a Windows host, we would target the
<em>SYSTEM</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup> user.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Wikipedia, 2021), <a href="https://en.wikipedia.org/wiki/Privilege_escalation" target="_blank">https://en.wikipedia.org/wiki/Privilege_escalation</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(Microsoft, 2021), <a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts#sec-localsystem" target="_blank">https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts#sec-localsystem</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Pivoting</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>In the context of post-exploitation, <em>pivoting</em> is using our access
one machine to target another machine. When we compromise a web
application and its server, we may be able to access other servers
that are behind a firewall or otherwise don't allow remote access.
For example, most web applications interact with databases. If the
database is running on another server, we usually cannot access it
directly as a remote user. However, if we've compromised the web
application server, we can likely access the database server from our
position on the web application server.</p>
<p>If we do pivot to other systems, we essentially start our attack
process over with a new Enumeration phase on the new targets. There
may be credentials or other useful material on the compromised server
that we can use to easily access other systems, such as the database
credentials used by the web application.</p>
</div><!----></div>

<!----><div><h2>Reporting</h2>
<p>This Learning Unit covers the following Learning Objectives:</p>
<ol>
<li>Understand the importance of documenting and reporting
vulnerabilities</li>
<li>Understand the importance of knowing your audience</li>
<li>Understand how to classify vulnerabilities</li>
<li>Understand how to assess the impact and severity of vulnerabilities</li>
</ol>
<p>This Learning Unit will take approximately 30 minutes to complete.</p>
<p>A web application assessment is only be as good as the report that
summarizes it. Our findings must be accurate and actionable for our
clients to take the report and improve their security posture. With
that in mind, when we draft a report, we need to know our audience,
classify vulnerabilities correctly, and honestly assess the impact and
severity of the vulnerabilities.</p>
</div><!---->

<h2>Knowing Your Audience</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>We should always try to adjust our report to match the audience that
will be reviewing it. If our client has an internal security team, we
may not need to include as many external references as we would to a
client with a small IT team and no full-time security team.</p>
</div><!----></div>

<h2>Classifying Vulnerabilities</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>There are many ways to classify and group vulnerabilities. Where
possible, we should use industry-standard vulnerability names in our
reports so our clients can easily find additional information online
if necessary.</p>
<p><em>Common Weakness Enumeration</em> (CWE)<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> is a commonly used list
of software and hardware flaws and vulnerabilities. The CWE list has
over a thousand entries categorized into several different views. One
drawback of using CWEs to classify vulnerabilities is that the items
on the list can be either too specific or overly broad. For example,
there are several different CWEs for <em>path traversal</em><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>
based on the type of payload. Despite these drawbacks, many tools will
reference CWEs, so it is important to familiarize ourselves with them.</p>
<p>Another common grouping of vulnerabilities for web applications is
the OWASP Top Ten. Refer to the Web Topic for more details on the
OWASP Top Ten.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(The MITRE Corporation, 2021), <a href="https://cwe.mitre.org/" target="_blank">https://cwe.mitre.org/</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div><div class="footnote-item" id="fn2"><sup>2</sup><p>(The MITRE Corporation, 2021),  <a href="https://cwe.mitre.org/data/definitions/23.html" target="_blank">https://cwe.mitre.org/data/definitions/23.html</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>

<h2>Assessing Impact and Severity</h2>

<div class="markdown-content text-main-color flex-grow my-6 mx-auto"><!----><div><p>Many organizations will rank vulnerability severities as High, Medium,
or Low. Some will also include Critical and Informational. Regardless
of which values we use, it is important not to overstate the severity
of a vulnerability. We must consider several factors when determining
the severity of a vulnerability.</p>
<p>We should think about the <em>impact</em> of an attacker exploiting the
vulnerability. How many users would be affected? What type of data
could the attacker access? Could the vulnerability disrupt the ability
to perform normal business operations?</p>
<p>We also need to consider the <em>likelihood</em> of an attacker exploiting
the vulnerability. Is the vulnerability difficult to discover or
exploit? Are custom tools or insider knowledge required to exploit the
vulnerability?</p>
<p>Vulnerabilities that are highly likely to be exploited and have the
potential to impact business operations may be Critical or High. On
the other hand, if a vulnerability that is difficult to discover and
exploit has little or negligible impact, it might be considered Low.</p>
<p>We can use a framework, like the <em>Common Vulnerability Scoring System</em>
(CVSS),<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> to remove some of the guesswork of calculating
severity. CVSS v3.1 uses fifteen metrics across Base, Temporal, and
Environmental groups to calculate a score from 0 to 10. Organizations
can use that numeric value as is or translate it to their ranking
system of choice.</p>
<section class="footnote-container"><div class="footnote-item" id="fn1"><sup>1</sup><p>(Forum of Incident Response and Security Teams, 2021), <a href="https://www.first.org/cvss/v3.1/specification-document" target="_blank">https://www.first.org/cvss/v3.1/specification-document</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</div></section></div><!----></div>